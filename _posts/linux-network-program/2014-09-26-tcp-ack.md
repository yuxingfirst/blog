---
title: TCP ACK机制分析
layout: post
categories: [网络编程]
tags: [network]
description: tcp ack.
---  

###1. 为什么要ACK  
我们知道，TCP是一种可靠的数据传输协议，那么为什么说它是可靠的呢? TCP的可靠性又是靠什么来保证的呢? 其中最重要的一个特性就是TCP的数据确认应答机制， 即是说接收方每收到一个数据包，都会向发送方发送一个应答，即ACK。    

我们知道， 在TCP首部中，有一个32位的确认号字段，这个字段实际上是指接收端希望接受的下一个字节的序列号。所以接收端在成功接受到部分数据后，其发送的应答数据包中的应答序列号(确认号)被设置为这些数据包中最后一个字节的序列号加1。  
  
同时，TCP首部中的32位序列号字段表示包含该TCP首部的数据包中所包含数据的第一个字节的序列号(设为N)。如果接收端成功接受到该数据包， 之前又没有丢失数据包，则接收端发送的应答数据包中的应答序列号应该为： ***N+LEN***(LEN为接受的数据包的***数据长度***)。 该序列号也是发送端将要发送的下一个数据包中第一个字节的序列号。  
  
其次，需要注意的一点是，接收端在发送应答的时候不可跨越式应答，什么意思呢？ 举个列子：  

发送端发送了2个数据包，第一个数据包A中数据的序列号的范围是201 ~ 300， 第二个数据包B中数据的序列号范围是301 ~ 400， 并且接收端上一次发送应答的应答序列号是201。 由于网络原因， 数据包B先到达了，数据包A还在网络中，此时，接收端是不会对数据包B进行确认的。而是会不断发送应答序列号为201的应答数据包直到该序列号的包到达。  

我们通常所说的快速重传机制即发送端在连续接收到3个相同序列号的应答数据包后需要立刻重传应答序列号所表示的数据。因为此时表示极有可能出现了数据包丢失的情况，发送端需要重传序列号为201开始的数据包。


###2. 什么是Delay ACK(经受时延的ACK)

###3. Nagle算法  


-EOF-
